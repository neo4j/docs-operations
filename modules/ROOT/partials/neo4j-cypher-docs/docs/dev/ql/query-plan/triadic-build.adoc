[[query-plan-triadic-build]]
== Triadic Build ==
The `TriadicBuild` operator is used in conjunction with `TriadicFilter` to solve triangular queries, such as the very
common 'find my friend-of-friends that are not already my friend'. These two operators are specific to Pipelined
runtime and together perform the same logic as `TriadicSelection` does for other runtimes.
`TriadicBuild` builds a set of all friends, which is later used by `TriadicFilter`.
The example finds the names of all friends of my friends that are not already my friends.

.Query
include::includes/query-plan-triadic-build.query.adoc[]



.Query Plan
[source]
----
Compiler CYPHER 4.4

Planner COST

Runtime PIPELINED

Runtime version 4.4

+-----------------+----------------------------------------+----------------+------+---------+----------------+------------------------+-----------+---------------------+
| Operator        | Details                                | Estimated Rows | Rows | DB Hits | Memory (Bytes) | Page Cache Hits/Misses | Time (ms) | Other               |
+-----------------+----------------------------------------+----------------+------+---------+----------------+------------------------+-----------+---------------------+
| +ProduceResults | `other.name`                           |              0 |    2 |       0 |                |                    0/0 |     0.080 | In Pipeline 3       |
| |               +----------------------------------------+----------------+------+---------+----------------+------------------------+-----------+---------------------+
| +Projection     | other.name AS `other.name`             |              0 |    2 |       4 |                |                    2/0 |     0.067 | In Pipeline 3       |
| |               +----------------------------------------+----------------+------+---------+----------------+------------------------+-----------+---------------------+
| +TriadicFilter  | WHERE NOT (me)--(other)                |              0 |    2 |       0 |           6984 |                    0/0 |     0.108 | In Pipeline 3       |
| |               +----------------------------------------+----------------+------+---------+----------------+------------------------+-----------+---------------------+
| +Apply          |                                        |              0 |    2 |       0 |                |                    0/0 |           |                     |
| |\              +----------------------------------------+----------------+------+---------+----------------+------------------------+-----------+---------------------+
| | +Filter       | not anon_2 = anon_4                    |              0 |    2 |       0 |                |                        |           | Fused in Pipeline 2 |
| | |             +----------------------------------------+----------------+------+---------+----------------+                        |           +---------------------+
| | +Expand(All)  | (anon_3)-[anon_4:FRIENDS_WITH]-(other) |              0 |    6 |      14 |                |                        |           | Fused in Pipeline 2 |
| | |             +----------------------------------------+----------------+------+---------+----------------+                        |           +---------------------+
| | +Argument     | anon_3, anon_2                         |              4 |    4 |       0 |           4200 |                    0/0 |     0.357 | Fused in Pipeline 2 |
| |               +----------------------------------------+----------------+------+---------+----------------+------------------------+-----------+---------------------+
| +TriadicBuild   | (me)--(anon_3)                         |              4 |    4 |       0 |           3392 |                    0/0 |     0.265 | In Pipeline 1       |
| |               +----------------------------------------+----------------+------+---------+----------------+------------------------+-----------+---------------------+
| +Expand(All)    | (me)-[anon_2:FRIENDS_WITH]-(anon_3)    |              4 |    4 |      19 |                |                        |           | Fused in Pipeline 0 |
| |               +----------------------------------------+----------------+------+---------+----------------+                        |           +---------------------+
| +Filter         | me:Person                              |             14 |   14 |       0 |                |                        |           | Fused in Pipeline 0 |
| |               +----------------------------------------+----------------+------+---------+----------------+                        |           +---------------------+
| +AllNodesScan   | me                                     |             35 |   35 |      36 |            112 |                    2/0 |     0.371 | Fused in Pipeline 0 |
+-----------------+----------------------------------------+----------------+------+---------+----------------+------------------------+-----------+---------------------+

Total database accesses: 73, total allocated memory: 7248

----
